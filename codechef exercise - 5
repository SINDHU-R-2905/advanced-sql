1.Write a query to do the following

Categorise the students based on the marks into grades.
Marks Less than 50 - C,
Marks between 50 and 80 - B,
Marks more than 80 - A
You need to output the following - 'Grades' and 'student_count'
Give the Alias name for the CASE as 'Grades'
Count the students in each category and assign it the alias 'student_count'
Your table 'marks' has the following columns :

St_id
Marks


select 
CASE
when marks < 50 then 'C'
when marks between  50 and 80 then 'B'
when marks > 80 then 'A'
ELSE 'NA'
end AS Grades,
COUNT (*) AS Student_count
from marks
group by Grades;


2.Task
Write a query to count the number of students across departments who has scored more than 80 marks.
Alias the count coulmn as 'Dept_HighScore_Count' Your table 'student' has the following columns:

St_id
St_name
Marks
Department
Expected output
┌────────────┬──────────────────────┐
│ department │ Dept_HighScore_Count │
├────────────┼──────────────────────┤
│ Biology    │ 0                    │
│ English    │ 0                    │
│ History    │ 3                    │
│ Math       │ 4                    │
│ Physics    │ 4                    │
└────────────┴──────────────────────┘

select 
department,
COUNT(CASE WHEN marks>80 THEN 1 ELSE NULL END)AS Dept_HighScore_Count
from student
GROUP BY department;


3.Sum using Case
We've learned the concept of SUM, that its used to find the sum of the cells of a particular column.
Adding CASE to the sum, helps us to filter out the cells which are to be considered while calculating the sum of a column

Below is a query to find the sum of salaries of the employee across department who has an experience more than 3 years , from table 'employee':

       SELECT Department,
       SUM(CASE WHEN Exp >3 THEN Salary ELSE 0 END) as Sum_High_Salary 
       FROM employee
       GROUP BY 1;
In the above query,

The CASE statement is used to check if the Exp column value is greater than 3
If the condition is true, the Salary of the employee is added to the sum; otherwise, 0 is added.
The SUM function then calculates the sum of all the salaries that meet the condition.
The resulting sum is given an alias of Sum_High_Salary.
Task
Write a query to find the sum of fee paid by the students, aged above 20 across departments.
Alias the sum column as 'Sum_Senior_Fee'.
You need to output the columns - 'Department' and 'Sum_Senior_Fee'.

Expected output
┌────────────┬────────────────┐
│ Department │ Sum_Senior_Fee │
├────────────┼────────────────┤
│ English    │ 5700           │
│ History    │ 1800           │
│ Math       │ 3700           │
│ Science    │ 4700           │
└────────────┴────────────────┘
Your table 'student' has the following columns:

St_id
St_name
Fee
Department
Age


select 
department,
SUM(CASE WHEN AGE > 20 THEN FEE ELSE 0 END)AS Sum_Senior_Fee
from student
Group by department;

4.Write a query to find the percentage of fee paid by the students, aged above 20 to the total fee by all the students across department.
Alias the resulting percentage column as Senior_Fee_Percentage.
Output the columns 'Department' and 'Senior_Fee_Percentage'.

Expected output
┌────────────┬───────────────────────┐
│ Department │ Senior_Fee_Percentage │
├────────────┼───────────────────────┤
│ English    │ 75                    │
│ History    │ 32                    │
│ Math       │ 48                    │
│ Science    │ 51                    │
└────────────┴───────────────────────┘
Your table 'student' has the following columns:

St_id
St_name
Fee
Department
Age


select
department,
100.0 * sum(CASE WHEN AGE > 20 THEN fee ELSE 0 END) / SUM(Fee) AS Senior_Fee_Percentage
from student
group by department;
